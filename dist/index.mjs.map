{"version":3,"file":"index.mjs","sources":["../src/style.ts","../src/peak/Peak.tsx","../src/util/template.ts","../src/renderer/renderer.ts","../src/selector/components/Tabs.tsx","../src/selector/context.ts","../static/Ripple-1.3s-237px.svg","../static/error.svg","../src/store/style.ts","../src/selector/components/Indicator.tsx","../src/selector/components/FaceView.tsx","../src/selector/components/FlexboxView.tsx","../src/selector/components/FaceSelector.tsx","../src/FacePackage.ts","../src/util/importJSON.ts","../src/FacePacksImporter.ts","../template/SakurairoDeployer.tsx"],"sourcesContent":["import { css } from \"@emotion/css\";\n/**\n * 定义主体高度\n */\nexport const mainHeight = 325\n\nexport const borderShadow = css({\n    boxShadow: '2px 2px 15px #888888',\n    border: '0.5px #888888 solid',\n    zIndex: 999,\n})\nexport const bgWhiteBlur = css({\n    backgroundColor: 'rgba(255,255,255,0.6)',\n    backdropFilter: 'blur(3px)'\n})\nexport const main = css({\n    padding: '2px',\n    height: mainHeight\n})","import * as generic from '../style';\nimport { css } from '@emotion/css';\nimport { createEffect, createSignal, JSX, onCleanup, onMount } from 'solid-js';\nimport { autoUpdate, computePosition, flip, shift } from '@floating-ui/dom'\n\nexport interface PeakProps {\n    /**\n     * 未提供时不会渲染\n     */\n    imgUrl?: string\n    imgCaption?: string\n    show: boolean\n    class?: string\n    anchor?: HTMLElement\n}\n\nconst styleFigCaption = css({\n    textAlign: \"center\", backgroundColor: 'rgba(255,255,255,0.65)'\n})\nconst styleHr = css({\n    marginTop: 0, marginBottom: 0\n})\n\nexport function Peak(props: PeakProps) {\n    const [style, setStyle] = createSignal<JSX.CSSProperties>({\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: 'max-content'\n    })\n    let refSelf: HTMLElement | undefined\n\n    const updatePosition = async () => {\n        const position = await computePosition(\n            props.anchor!,\n            refSelf!,\n            {\n                middleware: [shift(), flip()]\n            }\n        )\n        setStyle((prevStyle) => {\n            return {\n                ...prevStyle,\n                left: `${position.x}px`,\n                top: `${position.y}px`,\n            }\n        })\n    }\n    let cleanup: (() => void) | undefined\n    onCleanup(() => cleanup?.())\n\n\n    createEffect(async () => {\n        if (props.anchor && refSelf) {\n            cleanup = autoUpdate(\n                props.anchor,\n                refSelf,\n                updatePosition\n            );\n        } else {\n            cleanup?.();\n            cleanup = undefined\n        }\n    })\n    const show = () => Boolean(props.imgUrl) && props.show\n    return (\n        <figure style={{ display: show() ? 'block' : 'none',/*  ...props.style */ ...style() }}\n            classList={{\n                ...props.class ? { [props.class]: true } : {},\n                [generic.borderShadow]: true,\n                [generic.bgWhiteBlur]: true,\n            }}\n            ref={refSelf}\n        >\n            <img src={props.imgUrl} height={200} />\n            <hr class={styleHr} />\n            <figcaption\n                classList={{\n                    [styleFigCaption]: true,\n                    [generic.bgWhiteBlur]: true,\n                }}\n            >\n                {props.imgCaption}\n            </figcaption>\n        </figure>\n    );\n}","export function processTemplate(left_bracket: string, right_bracket: string, replacePlaceHolder: (str: string) => string, str: string) {\n    let inBracket = false, newText = \"\", bracketContent = \"\"\n    for (const char of str) {\n        switch (char) {\n            case left_bracket:\n                if (inBracket) {\n                    if (left_bracket == right_bracket) {\n                        inBracket = false\n                        newText += replacePlaceHolder(bracketContent)\n                        bracketContent = \"\"\n                    } else {\n                        inBracket = false\n                        newText += `${left_bracket}${bracketContent}${left_bracket}`\n                        bracketContent = \"\"\n                    }\n                } else {\n                    inBracket = true\n                }\n                break\n            case right_bracket:\n                if (inBracket) {\n                    inBracket = false\n                    newText += replacePlaceHolder(bracketContent)\n                    bracketContent = \"\"\n                } else {\n                    newText += char\n                }\n                break\n            case ' ':\n            case '\\n':\n            case '\\r':\n            case '\\t':\n            case '\\v':\n            case '\\f':\n                //跳过空白字符\n                //取消状态并放回字符\n                if (inBracket) {\n                    inBracket = false\n                    newText += `${left_bracket}${bracketContent}${char}`\n                    bracketContent = \"\"\n                } else {\n                    newText += char\n                }\n                break\n\n            default:\n                if (inBracket) {\n                    bracketContent += char\n                } else {\n                    newText += char\n                }\n        }\n    }\n    //for end\n    if (bracketContent != '') {\n        newText += left_bracket + bracketContent\n        inBracket = false\n    }\n    if (inBracket) {\n        newText += left_bracket\n    }\n    return newText\n}","import { FacePackage } from \"../FacePackage\"\nimport { processTemplate } from \"../util/template\"\n/**\n * 可选字段\n */\ninterface FaceRendererPropOptional {\n    imgClassName?: string\n    imgInlineStyle?: string\n    leftBracket?: string\n    rightBracket?: string\n}\nexport interface FaceRendererProp extends FaceRendererPropOptional {\n    facePackages: Array<FacePackage>\n}\n\n/**\n * 创建渲染器\n * @param param0 \n * @returns \n */\nexport function createFaceRenderer(\n    {\n        facePackages,\n        imgClassName = '',\n        imgInlineStyle = 'max-height:6vh;',\n        leftBracket = ':',\n        rightBracket = ':'\n    }: FaceRendererProp) {\n    const map: Record<string, string> = {}\n    for (const pack of facePackages) {\n        for (const face of pack.faces) {\n            map[`${pack.id}.${face.id}`] = face.url\n        }\n    }\n    const replacePlaceHolder = (placeHolder: string) => {\n        const url = map[placeHolder]\n        if (url) {\n            return `<img class=\"${imgClassName}\" src=\"${url}\" style=\"${imgInlineStyle}\" alt=\"${leftBracket}${placeHolder}${rightBracket}\"/>`\n        } else {\n            return `${leftBracket}${placeHolder}${rightBracket}`\n        }\n    }\n    const renderText = (text: string) => processTemplate(leftBracket, rightBracket, replacePlaceHolder, text)\n\n    return function renderFace(displayOn: Element | string) {\n        if (typeof displayOn === 'string') {\n            return renderText(displayOn)\n        } else {\n            const raw = displayOn.innerHTML\n            const result = renderText(raw)\n            if (result !== raw) displayOn.innerHTML = result\n        }\n    }\n}","import { FacePackage } from '../../FacePackage';\nimport { bgWhiteBlur } from '../../style';\nimport { css } from '@emotion/css';\nimport { createSelector, For, JSX } from 'solid-js';\n\nexport interface TabProps extends JSX.OptionHTMLAttributes<HTMLOptionElement> {\n    pos: number\n    name: string\n    selected: boolean\n}\n/**\n *选项卡的单个标签\n *\n * @author KotoriK\n * @export\n * @param {TabProps} props\n * @returns\n */\nfunction Tab(props: TabProps) {\n    return (\n        <option selected={props.selected} style={props.style} class={props.class}\n            value={props.pos}>\n            {props.name}\n        </option>\n    )\n}\n\nexport interface TabsProps extends JSX.CustomAttributes<HTMLSelectElement> {\n    facePackages: Array<FacePackage>,\n    onSelect: (newPos: number) => void,\n    selectedPos: number\n}\n\nconst styles = css({\n    width: \"100%\", border: 0, fontWeight: 'bold'\n})\n/**\n * 选项卡的一行标签（一行Tab\n *\n * @author KotoriK\n */\nexport default function Tabs(props: TabsProps) {\n    const isSelected = createSelector(() => props.selectedPos)\n    return (\n        <select ref={props.ref}\n            classList={{ [styles]: true, [bgWhiteBlur]: true }}\n            onChange={(e) => props.onSelect(parseInt(e.currentTarget.value))}>\n            <For each={props.facePackages}>\n                {(item, index) =>\n                    <Tab pos={index()} name={item.name}\n                        selected={isSelected(index())} />\n                }\n            </For>\n        </select>\n    )\n}","import { createContext } from \"solid-js\";\r\nimport { Face } from \"../FacePackage\";\r\n\r\nexport const SelectorContext = createContext<SelectorContextType>()\r\nexport interface SelectorContextType {\r\n    select: (face: Face) => void,\r\n    inspect: (face?: Face) => void\r\n}","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHN0eWxlPSJtYXJnaW46IGF1dG87IGJhY2tncm91bmQ6IG5vbmU7IGRpc3BsYXk6IGJsb2NrOyBzaGFwZS1yZW5kZXJpbmc6IGF1dG87IiB3aWR0aD0iMjM3cHgiIGhlaWdodD0iMjM3cHgiIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+PGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iMzkuNDk5NiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODVhMmI2IiBzdHJva2Utd2lkdGg9IjMiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjEuMjk4NzAxMjk4NzAxMjk4N3MiIHZhbHVlcz0iMDs0MCIga2V5VGltZXM9IjA7MSIga2V5U3BsaW5lcz0iMCAwLjIgMC44IDEiIGNhbGNNb2RlPSJzcGxpbmUiIGJlZ2luPSItMC42NDkzNTA2NDkzNTA2NDkzcyI+PC9hbmltYXRlPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjEuMjk4NzAxMjk4NzAxMjk4N3MiIHZhbHVlcz0iMTswIiBrZXlUaW1lcz0iMDsxIiBrZXlTcGxpbmVzPSIwLjIgMCAwLjggMSIgY2FsY01vZGU9InNwbGluZSIgYmVnaW49Ii0wLjY0OTM1MDY0OTM1MDY0OTNzIj48L2FuaW1hdGU+PC9jaXJjbGU+PGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iMjMuODUzMSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYmJjZWRkIiBzdHJva2Utd2lkdGg9IjMiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjEuMjk4NzAxMjk4NzAxMjk4N3MiIHZhbHVlcz0iMDs0MCIga2V5VGltZXM9IjA7MSIga2V5U3BsaW5lcz0iMCAwLjIgMC44IDEiIGNhbGNNb2RlPSJzcGxpbmUiPjwvYW5pbWF0ZT48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgZHVyPSIxLjI5ODcwMTI5ODcwMTI5ODdzIiB2YWx1ZXM9IjE7MCIga2V5VGltZXM9IjA7MSIga2V5U3BsaW5lcz0iMC4yIDAgMC44IDEiIGNhbGNNb2RlPSJzcGxpbmUiPjwvYW5pbWF0ZT48L2NpcmNsZT48IS0tIFtsZGlvXSBnZW5lcmF0ZWQgYnkgaHR0cHM6Ly9sb2FkaW5nLmlvLyAtLT48L3N2Zz4=\"","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTkyMjA4MTM2OTkwIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjMzOTAiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNTEyIDEwMDAuNzI3MjczYTQ4OC43MjcyNzMgNDg4LjcyNzI3MyAwIDEgMSA0ODguNzI3MjczLTQ4OC43MjcyNzMgNDg4LjcyNzI3MyA0ODguNzI3MjczIDAgMCAxLTQ4OC43MjcyNzMgNDg4LjcyNzI3M3ogbTAtOTE5LjI3MjcyOGE0MzAuNTQ1NDU1IDQzMC41NDU0NTUgMCAxIDAgNDMwLjU0NTQ1NSA0MzAuNTQ1NDU1QTQzMC41NDU0NTUgNDMwLjU0NTQ1NSAwIDAgMCA1MTIgODEuNDU0NTQ1eiIgZmlsbD0iIiBwLWlkPSIzMzkxIj48L3BhdGg+PHBhdGggZD0iTTcyMS40NTQ1NDUgNzUwLjU0NTQ1NWEyOC45NzQ1NDUgMjguOTc0NTQ1IDAgMCAxLTIwLjU5NjM2My04LjQ5NDU0NkwyODEuNiAzMjIuNDQzNjM2YTI5LjA5MDkwOSAyOS4wOTA5MDkgMCAwIDEgNDEuMTkyNzI3LTQxLjE5MjcyN0w3NDIuNCA3MDAuODU4MTgyQTI5LjA5MDkwOSAyOS4wOTA5MDkgMCAwIDEgNzIxLjQ1NDU0NSA3NTAuNTQ1NDU1eiIgZmlsbD0iIiBwLWlkPSIzMzkyIj48L3BhdGg+PHBhdGggZD0iTTMwMi41NDU0NTUgNzUwLjU0NTQ1NWEyOS4wOTA5MDkgMjkuMDkwOTA5IDAgMCAxLTIwLjU5NjM2NC00OS42ODcyNzNsNDE5LjI1ODE4Mi00MTkuNjA3MjczYTI5LjA5MDkwOSAyOS4wOTA5MDkgMCAwIDEgNDEuMTkyNzI3IDQxLjE5MjcyN0wzMjIuNzkyNzI3IDc0Mi4wNTA5MDlhMjguOTc0NTQ1IDI4Ljk3NDU0NSAwIDAgMS0yMC4yNDcyNzIgOC40OTQ1NDZ6IiBmaWxsPSIiIHAtaWQ9IjMzOTMiPjwvcGF0aD48L3N2Zz4=\"","import { createStore } from 'solid-js/store'\r\n\r\nimport PendingIndicator from '../../static/Ripple-1.3s-237px.svg'\r\nimport ErrorIndicator from '../../static/error.svg'\r\n\r\nexport interface FaceSelectorStyle {\r\n    svg: {\r\n        pending: string,\r\n        error: string\r\n    }\r\n}\r\nexport const [styleSetting, setStyleSetting] = createStore<FaceSelectorStyle>({} as any)\r\n\r\nexport const defaultStyle: FaceSelectorStyle = {\r\n    svg: {\r\n        pending:   PendingIndicator,\r\n        error: ErrorIndicator,\r\n    }\r\n}\r\n/**\r\n * defaultStyle，但是从JSDelivr拉SVG\r\n */\r\nexport const defaultStyleJSDelivr: FaceSelectorStyle = {\r\n    svg: {\r\n        pending: \"https://cdn.jsdelivr.net/gh/YukiCat-Dev/FacePack/static/Ripple-1.3s-237px.svg\",\r\n        error: \"https://cdn.jsdelivr.net/gh/YukiCat-Dev/FacePack/static/error.svg\",\r\n    }\r\n}\r\n","import type { JSX } from \"solid-js/jsx-runtime\"\nimport { FaceSelectorStyle, styleSetting } from \"../../store/style\";\nimport { splitProps } from \"solid-js\";\n\nexport type IndicateLevel = keyof FaceSelectorStyle['svg']\nexport interface IndicatorProps extends Omit<JSX.ImgHTMLAttributes<HTMLImageElement>, 'src'> {\n    level: IndicateLevel\n}\n/**\n *一个指示错误的组件\n *\n * @author KotoriK\n * @export\n * @param {IndicatorProps} props\n * @returns\n */\n\nexport default function Indicator(prop: IndicatorProps) {\n    const [{ level }, otherProp] = splitProps(prop, ['level'])\n    return <img src={styleSetting.svg[level]} {...otherProp} />\n}","\nimport { createSignal, splitProps, useContext } from 'solid-js';\nimport type { JSX } from 'solid-js/jsx-runtime';\nimport { Face } from '../../FacePackage';\nimport { SelectorContext } from '../context';\nimport Indicator, { } from './Indicator';\nexport interface FaceViewProps extends Omit<JSX.ImgHTMLAttributes<HTMLImageElement>, 'onPointerOut' | 'onPointerEnter' | 'onLoad' | 'onError' | 'src' | 'alt' | 'hidden'> {\n    face: Face\n}\n/**\n * 表情的渲染\n *\n * @author KotoriK\n * @param {FaceViewProps} props\n * @returns\n */\nexport default function FaceView(props: FaceViewProps) {\n    const [loaded, setLoaded] = createSignal(false)\n    const [error, setError] = createSignal(false)\n    const handleError = () => {\n        setLoaded(false)\n        setError(true)\n    }\n    const handleLoad = () => {\n        setLoaded(true)\n        setError(false)\n    }\n\n    const [face, forwardProp] = splitProps(props, ['face'])\n    const context = useContext(SelectorContext)\n    return (\n        <>\n            {(!loaded() || error()) &&\n                <Indicator\n                    level={error() ? 'error' : 'pending'}\n                    alt={face.face.descr ?? face.face.id}\n                    style={{ /* ...props.style, */ transition: \"opacity 2s ease\" }}\n                    {...forwardProp}\n                />}\n            <img {...forwardProp}\n                src={face.face.url}\n                alt={face.face.descr ?? face.face.id}\n                onClick={context?.select.bind(undefined, face.face)}\n                onPointerEnter={context?.inspect.bind(undefined, face.face)}\n                onPointerOut={context?.inspect.bind(undefined, undefined)}\n                onLoad={handleLoad}\n                hidden={!loaded}\n                onError={handleError} />\n        </>\n    )\n}","import { css } from \"@emotion/css\";\nimport { For } from \"solid-js\";\nimport { FacePackage } from \"../../FacePackage\";\nimport FaceView from './FaceView'\n\nconst styleCol = css({\n    flex: 1, width: \"45px\", height: \"45px\", padding: \"1px 1px 1px 1px\"\n})\nconst styleRow = css({\n    flexWrap: \"wrap\", overflow: \"auto\", gap: 2\n})\n\nexport interface FlexboxViewProp {\n    /**\n     *\n     * 要显示的表情包\n     * @type {FacePackage}\n     * @memberof TableViewProps\n     */\n    facePackage: FacePackage\n}\n\nexport default function FlexboxView(props: FlexboxViewProp) {\n    return <div class={styleRow}>\n        <For each={props.facePackage.faces}>\n            {\n                face => <FaceView\n                    face={face}\n                    class={styleCol} />\n            }\n        </For>\n    </div>\n\n}","import { FacePackage, Face } from '../../FacePackage';\nimport Tabs from './Tabs';\nimport FlexboxView from './FlexboxView';\nimport { createSignal, JSX } from 'solid-js';\nimport { borderShadow, bgWhiteBlur, main } from '../../style';\nimport { SelectorContext } from '../context';\nimport { FaceSelectorState } from '../../store';\n\nexport interface FaceSelectorProps {\n    /**\n    *  加载的表情包集\n    */\n    facePacks: Array<FacePackage>,\n    /**\n    *  实现隐藏FaceSelector的方法\n    */\n    handleHide: Function\n    /**\n    * 指示是否加载表情\n    */\n    loadContent: boolean\n    class?: string\n    style?: JSX.CSSProperties | string\n    ref?: HTMLDivElement\n    onSelect: (facePack: FacePackage, face: Face) => void\n}\n\n/**\n * 创建一个表情包选择器组件\n *\n * @author KotoriK\n * @returns 一个selectorState，和一个FaceSelector组件\n */\nexport function createFaceSelector() {\n    const [inspecting, inspect] = createSignal<Face | undefined>()\n\n    return [{\n        inspecting,\n    } as FaceSelectorState,\n    /**\n     *表情包选择器的完整主体\n     *\n     * @author KotoriK\n     * @export\n     * @param { children }\n     * @returns\n     */\n    function FaceSelector(props: FaceSelectorProps) {\n        const [_nowPackagePos, setPos] = createSignal(0)\n\n        /*     const head = useRef<HTMLSelectElement>()\n            const body = useRef<HTMLDivElement>() */\n        /*     const handleFaceSelected = useCallback((face_pos: number) => {\n                const nowPackage = facePacks[_nowPackagePos()]\n                onFaceSelected(nowPackage, nowPackage.faces[face_pos])\n                handleHide()\n            }, [handleHide, onFaceSelected, facePacks, _nowPackagePos]) */\n        /*     useEffect(() => {\n                //设定内网格高度\n                if (loadContent) body.current.style.height = classes.mainHeight - head.current.clientHeight + 'px'\n            }, [loadContent]) */\n\n        const nowPackagePos = () => {\n            const maxPos = props.facePacks.length - 1\n            const _now = _nowPackagePos()\n            if (_now > maxPos) return maxPos //防止prop发生改动带来越界\n            return _now\n        }\n\n        return <SelectorContext.Provider value={\n            {\n                select: (face) => props.onSelect(props.facePacks[nowPackagePos()], face),\n                inspect\n            }\n        }>\n            <div ref={props.ref}/* style={{ ...style }} */\n                classList={props.class ? {\n                    [props.class]: true\n                } : {\n                    [borderShadow]: true,\n                    [bgWhiteBlur]: true,\n                    [main]: true\n                }}\n                style={props.style}\n            >\n                <Tabs facePackages={props.facePacks}\n                    selectedPos={nowPackagePos()}\n                    onSelect={setPos}\n                />\n                {\n                    props.loadContent &&\n                    <FlexboxView facePackage={props.facePacks[nowPackagePos()]} />\n                }\n            </div>\n        </SelectorContext.Provider>\n    }] as const\n}","import { processTemplate } from \"./util/template\";\n\nexport interface FacePackage {\n    id: string\n\n    /**\n     * 表情包的友好名称\n     *\n     * @type {string}\n     * @memberof FacePackage\n     */\n    name: string\n    faces: Array<Face>\n    p_url?: string\n    default?: string\n}\nexport interface FacePackageDefine {\n    id: string\n\n    /**\n     * 表情包的友好名称\n     *\n     * @type {string}\n     * @memberof FacePackage\n     */\n    name: string\n    faces: Array<FaceDefine>\n    p_url?: string\n    default?: string\n}\nexport interface Face {\n\n    /**\n     * 与php方互通的表情id\n     *\n     * @type {string}\n     * @memberof Face\n     */\n    id: string\n\n    /**\n     *\n     * 表情的url\n     * @type {string}\n     * @memberof Face\n     */\n    url: string\n\n    /**\n     * 表情描述\n     */\n    descr?: string\n\n}\nexport type FaceDefine = {\n    id: string\n    url?: string\n} | string\nexport function getFaceFullUrl(face: FaceDefine, parentPack: FacePackageDefine | FacePackage) {\n    const _face = typeof face == \"string\" ? { id: face } : face\n    const _process = (ph: string) => processTemplate('{', '}', (str) => {\n        if (str == 'id') {\n            return _face.id\n        } else if (str in parentPack) {\n            return parentPack[str as keyof typeof parentPack] as string\n        } else {\n            return `{${str}}`\n        }\n    }, ph)\n    const { url, ...other_key } = _face\n    return {\n        ...other_key, url: _process(url && _process(url) || parentPack.default!)\n    }\n}","export const importJSON =\n    (url: string) => fetch(url)\n        .then(\n            (response) => {\n                if (response.ok) {\n                    return response.json()\n                } else {\n                    throw new Error(`Fetch Error:Return HTTP ${response.status}, ${response.statusText}`)\n                }\n            }\n        )\n","import { importJSON } from './util/importJSON'\nimport { FacePackage, FacePackageDefine, getFaceFullUrl } from './FacePackage'\nexport async function importExternalFacePacks(url: string) {\n    const json: Array<FacePackageDefine> = await importJSON(url)\n    if (json) {\n        preprocessFacePack(json)\n        return json as Array<FacePackage>\n    }\n    throw new Error(`Try to load FacePacks from '${url}' failed.`)\n}\nexport function preprocessFacePack(facepacks: Array<FacePackageDefine>) {\n    for (const pack of facepacks) {\n        pack.faces = pack.faces.map((face) => getFaceFullUrl(face, pack))\n    }\n}","import { createSignal, } from 'solid-js'\r\nimport { render } from 'solid-js/web'\r\nimport { createFaceRenderer, defaultStyle, FacePackage, setStyleSetting } from '../src'\r\nimport { Peak } from '../src/peak'\r\nimport { createFaceSelector } from '../src/selector/components/FaceSelector'\r\n\r\nexport function deployRenderer(facePackages: FacePackage[]) {\r\n    const render = createFaceRenderer({\r\n        facePackages: facePackages\r\n    })\r\n    setStyleSetting(defaultStyle)\r\n\r\n    document.querySelectorAll('article.hentry p:not(.ct-respond-form-textarea):not(.form-submit)').forEach(render)\r\n}\r\nexport function deploySelector(facePackages: FacePackage[]) {\r\n    let emotionBox: HTMLElement | null\r\n    let commentArea: HTMLTextAreaElement | HTMLInputElement | null\r\n    if ((emotionBox = document.querySelector<HTMLElement>('.emotion-box'))\r\n        && (commentArea = document.querySelector('#comment'))\r\n    ) {\r\n        const [{ inspecting }, FaceSelector] = createFaceSelector()\r\n        const [hide, setHide] = createSignal(true)\r\n        const [loadContent, setLoadContent] = createSignal(false)\r\n\r\n        render(() => <FaceSelector facePacks={facePackages}\r\n            loadContent={loadContent()}\r\n            handleHide={() => setHide(true)}\r\n            style={`display:${hide() ? 'none' : 'block'}`}\r\n            onSelect={(pack, face) => {\r\n                commentArea!.value += `:${pack.id}.${face.id}:`\r\n            }} />, emotionBox)\r\n        // init toggler\r\n        document.getElementById('emotion-toggle')?.addEventListener('click', () => {\r\n            setLoadContent(true)\r\n            setHide(prev => !prev)\r\n        })\r\n\r\n        // init Peak\r\n        const peak = document.createElement('div')\r\n        document.body.append(peak)\r\n        render(() => {\r\n            const imgCaption = () => {\r\n                const face = inspecting()\r\n                return face ? (face.descr ?? face.id) : undefined\r\n            }\r\n            return <Peak imgUrl={inspecting()?.url} imgCaption={imgCaption()} anchor={emotionBox!} show />\r\n        }, peak)\r\n    }\r\n}"],"names":["styleFigCaption","css","textAlign","backgroundColor","styleHr","marginTop","marginBottom","Peak","props","style","setStyle","createSignal","position","top","left","width","refSelf","updatePosition","computePosition","anchor","middleware","shift","flip","prevStyle","x","y","cleanup","onCleanup","createEffect","autoUpdate","undefined","show","Boolean","imgUrl","_tmpl$","_$use","_$className","_$insert","imgCaption","_$effect","display","class","generic","_$style","_$classList","_$setAttribute","Tab","name","selected","pos","styles","border","fontWeight","Tabs","isSelected","createSelector","selectedPos","e","onSelect","parseInt","currentTarget","value","ref","_$createComponent","facePackages","item","index","bgWhiteBlur","Indicator","prop","level","otherProp","splitProps","_$spread","_$mergeProps","styleSetting","svg","FaceView","loaded","setLoaded","error","setError","handleError","handleLoad","face","forwardProp","context","useContext","SelectorContext","_$memo","descr","id","transition","url","select","bind","inspect","styleCol","flex","height","padding","styleRow","flexWrap","overflow","gap","FlexboxView","facePackage","faces","createFaceSelector","inspecting","FaceSelector","_nowPackagePos","setPos","nowPackagePos","maxPos","facePacks","length","_now","loadContent","borderShadow","main","deployRenderer","render","createFaceRenderer","setStyleSetting","defaultStyle","document","querySelectorAll","forEach","deploySelector","emotionBox","commentArea","querySelector","hide","setHide","setLoadContent","pack","getElementById","addEventListener","prev","peak","createElement","body","append"],"mappings":";;;;;;AAIO,MAAM,UAAa,GAAA,GAAA,CAAA;AAEnB,MAAM,eAAe,GAAI,CAAA;AAAA,EAC5B,SAAW,EAAA,sBAAA;AAAA,EACX,MAAQ,EAAA,qBAAA;AAAA,EACR,MAAQ,EAAA,GAAA;AACZ,CAAC,CAAA,CAAA;AACM,MAAM,cAAc,GAAI,CAAA;AAAA,EAC3B,eAAiB,EAAA,uBAAA;AAAA,EACjB,cAAgB,EAAA,WAAA;AACpB,CAAC,CAAA,CAAA;AACM,MAAM,OAAO,GAAI,CAAA;AAAA,EACpB,OAAS,EAAA,KAAA;AAAA,EACT,MAAQ,EAAA,UAAA;AACZ,CAAC,CAAA;;;ACFD,MAAMA,eAAe,GAAGC,GAAG,CAAC;AACxBC,EAAAA,SAAS,EAAE,QAAQ;AAAEC,EAAAA,eAAe,EAAE,wBAAA;AAC1C,CAAC,CAAC,CAAA;AACF,MAAMC,OAAO,GAAGH,GAAG,CAAC;AAChBI,EAAAA,SAAS,EAAE,CAAC;AAAEC,EAAAA,YAAY,EAAE,CAAA;AAChC,CAAC,CAAC,CAAA;AAEK,SAASC,IAAI,CAACC,KAAgB,EAAE;AACnC,EAAA,MAAM,CAACC,OAAK,EAAEC,QAAQ,CAAC,GAAGC,YAAY,CAAoB;AACtDC,IAAAA,QAAQ,EAAE,UAAU;AACpBC,IAAAA,GAAG,EAAE,CAAC;AACNC,IAAAA,IAAI,EAAE,CAAC;AACPC,IAAAA,KAAK,EAAE,aAAA;AACX,GAAC,CAAC,CAAA;AACF,EAAA,IAAIC,OAAgC,CAAA;EAEpC,MAAMC,cAAc,GAAG,YAAY;IAC/B,MAAML,QAAQ,GAAG,MAAMM,eAAe,CAClCV,KAAK,CAACW,MAAM,EACZH,OAAO,EACP;AACII,MAAAA,UAAU,EAAE,CAACC,KAAK,EAAE,EAAEC,IAAI,EAAE,CAAA;AAChC,KAAC,CACJ,CAAA;IACDZ,QAAQ,CAAEa,SAAS,IAAK;MACpB,OAAO;AACH,QAAA,GAAGA,SAAS;AACZT,QAAAA,IAAI,EAAG,CAAA,EAAEF,QAAQ,CAACY,CAAE,CAAG,EAAA,CAAA;AACvBX,QAAAA,GAAG,EAAG,CAAA,EAAED,QAAQ,CAACa,CAAE,CAAA,EAAA,CAAA;OACtB,CAAA;AACL,KAAC,CAAC,CAAA;GACL,CAAA;AACD,EAAA,IAAIC,OAAiC,CAAA;AACrCC,EAAAA,SAAS,CAAC,MAAMD,OAAO,IAAI,CAAC,CAAA;AAG5BE,EAAAA,YAAY,CAAC,YAAY;AACrB,IAAA,IAAIpB,KAAK,CAACW,MAAM,IAAIH,OAAO,EAAE;MACzBU,OAAO,GAAGG,UAAU,CAChBrB,KAAK,CAACW,MAAM,EACZH,OAAO,EACPC,cAAc,CACjB,CAAA;AACL,KAAC,MAAM;AACHS,MAAAA,OAAO,IAAI,CAAA;AACXA,MAAAA,OAAO,GAAGI,SAAS,CAAA;AACvB,KAAA;AACJ,GAAC,CAAC,CAAA;AACF,EAAA,MAAMC,IAAI,GAAG,MAAMC,OAAO,CAACxB,KAAK,CAACyB,MAAM,CAAC,IAAIzB,KAAK,CAACuB,IAAI,CAAA;AACtD,EAAA,OAAA,CAAA,MAAA;AAAA,IAAA,MAAA,IAAA,GAAAG,QAAA,CAAA,SAAA,CAAA,IAAA,CAAA;AAAA,MAAA,KAAA,GAAA,IAAA,CAAA,UAAA;AAAA,MAAA,KAAA,GAAA,KAAA,CAAA,WAAA;AAAA,MAAA,KAAA,GAAA,KAAA,CAAA,WAAA,CAAA;AAAA,IAAA,MAAA,KAAA,GAOalB,OAAO,CAAA;AAAA,IAAA,OAAA,KAAA,KAAA,UAAA,GAAAmB,GAAA,CAAA,KAAA,EAAA,IAAA,CAAA,GAAPnB,OAAO,GAAA,IAAA,CAAA;AAAA,IAAAoB,SAAA,CAAA,KAAA,EAGDhC,OAAO,CAAA,CAAA;IAAAiC,MAOb7B,CAAAA,KAAAA,EAAAA,MAAAA,KAAK,CAAC8B,UAAU,CAAA,CAAA;AAAA,IAAAC,MAAA,CAAA,GAAA,IAAA;MAAA,MAhBV,GAAA,GAAA;AAAEC,UAAAA,OAAO,EAAET,IAAI,EAAE,GAAG,OAAO,GAAG,MAAM;AAAC,+BAAsB,GAAGtB,OAAK,EAAA;SAAI;QAAA,IACvE,GAAA;UACP,IAAGD,KAAK,CAACiC,KAAK,GAAG;YAAE,CAACjC,KAAK,CAACiC,KAAK,GAAG,IAAA;WAAM,GAAG,EAAE,CAAA;AAC7C,UAAA,CAACC,YAAoB,GAAG,IAAI;UAC5B,CAACA,WAAmB,GAAG,IAAA;SAC1B;QAAA,IAGSlC,GAAAA,KAAK,CAACyB,MAAM;QAAA,IAGP,GAAA;UACP,CAACjC,eAAe,GAAG,IAAI;UACvB,CAAC0C,WAAmB,GAAG,IAAA;SAC1B,CAAA;AAAA,MAAA,GAAA,CAAA,GAAA,GAAAC,KAAA,CAAA,IAAA,EAAA,GAAA,EAAA,GAAA,CAAA,GAAA,CAAA,CAAA;AAAA,MAAA,GAAA,CAAA,IAAA,GAAAC,SAAA,CAAA,IAAA,EAAA,IAAA,EAAA,GAAA,CAAA,IAAA,CAAA,CAAA;AAAA,MAAA,IAAA,KAAA,GAAA,CAAA,IAAA,IAAAC,YAAA,CAAA,KAAA,EAAA,KAAA,EAAA,GAAA,CAAA,IAAA,GAAA,IAAA,CAAA,CAAA;AAAA,MAAA,GAAA,CAAA,IAAA,GAAAD,SAAA,CAAA,KAAA,EAAA,IAAA,EAAA,GAAA,CAAA,IAAA,CAAA,CAAA;AAAA,MAAA,OAAA,GAAA,CAAA;AAAA,KAAA,EAAA;AAAA,MAAA,GAAA,EAAA,SAAA;AAAA,MAAA,IAAA,EAAA,SAAA;AAAA,MAAA,IAAA,EAAA,SAAA;AAAA,MAAA,IAAA,EAAA,SAAA;AAAA,KAAA,CAAA,CAAA;AAAA,IAAA,OAAA,IAAA,CAAA;AAAA,GAAA,GAAA,CAAA;AAMjB;;ACtFO,SAAS,eAAgB,CAAA,YAAA,EAAsB,aAAuB,EAAA,kBAAA,EAA6C,GAAa,EAAA;AACnI,EAAA,IAAI,SAAY,GAAA,KAAA,EAAO,OAAU,GAAA,EAAA,EAAI,cAAiB,GAAA,EAAA,CAAA;AACtD,EAAA,KAAA,MAAW,QAAQ,GAAK,EAAA;AACpB,IAAA,QAAQ,IAAM;AAAA,MACV,KAAK,YAAA;AACD,QAAA,IAAI,SAAW,EAAA;AACX,UAAA,IAAI,gBAAgB,aAAe,EAAA;AAC/B,YAAY,SAAA,GAAA,KAAA,CAAA;AACZ,YAAA,OAAA,IAAW,mBAAmB,cAAc,CAAA,CAAA;AAC5C,YAAiB,cAAA,GAAA,EAAA,CAAA;AAAA,WACd,MAAA;AACH,YAAY,SAAA,GAAA,KAAA,CAAA;AACZ,YAAW,OAAA,IAAA,CAAA,EAAG,eAAe,cAAiB,CAAA,EAAA,YAAA,CAAA,CAAA,CAAA;AAC9C,YAAiB,cAAA,GAAA,EAAA,CAAA;AAAA,WACrB;AAAA,SACG,MAAA;AACH,UAAY,SAAA,GAAA,IAAA,CAAA;AAAA,SAChB;AACA,QAAA,MAAA;AAAA,MACJ,KAAK,aAAA;AACD,QAAA,IAAI,SAAW,EAAA;AACX,UAAY,SAAA,GAAA,KAAA,CAAA;AACZ,UAAA,OAAA,IAAW,mBAAmB,cAAc,CAAA,CAAA;AAC5C,UAAiB,cAAA,GAAA,EAAA,CAAA;AAAA,SACd,MAAA;AACH,UAAW,OAAA,IAAA,IAAA,CAAA;AAAA,SACf;AACA,QAAA,MAAA;AAAA,MACJ,KAAK,GAAA,CAAA;AAAA,MACL,KAAK,IAAA,CAAA;AAAA,MACL,KAAK,IAAA,CAAA;AAAA,MACL,KAAK,GAAA,CAAA;AAAA,MACL,KAAK,IAAA,CAAA;AAAA,MACL,KAAK,IAAA;AAGD,QAAA,IAAI,SAAW,EAAA;AACX,UAAY,SAAA,GAAA,KAAA,CAAA;AACZ,UAAW,OAAA,IAAA,CAAA,EAAG,eAAe,cAAiB,CAAA,EAAA,IAAA,CAAA,CAAA,CAAA;AAC9C,UAAiB,cAAA,GAAA,EAAA,CAAA;AAAA,SACd,MAAA;AACH,UAAW,OAAA,IAAA,IAAA,CAAA;AAAA,SACf;AACA,QAAA,MAAA;AAAA,MAEJ;AACI,QAAA,IAAI,SAAW,EAAA;AACX,UAAkB,cAAA,IAAA,IAAA,CAAA;AAAA,SACf,MAAA;AACH,UAAW,OAAA,IAAA,IAAA,CAAA;AAAA,SACf;AAAA,KACR;AAAA,GACJ;AAEA,EAAA,IAAI,kBAAkB,EAAI,EAAA;AACtB,IAAA,OAAA,IAAW,YAAe,GAAA,cAAA,CAAA;AAC1B,IAAY,SAAA,GAAA,KAAA,CAAA;AAAA,GAChB;AACA,EAAA,IAAI,SAAW,EAAA;AACX,IAAW,OAAA,IAAA,YAAA,CAAA;AAAA,GACf;AACA,EAAO,OAAA,OAAA,CAAA;AACX;;AC1CO,SAAS,kBACZ,CAAA;AAAA,EACI,YAAA;AAAA,EACA,YAAe,GAAA,EAAA;AAAA,EACf,cAAiB,GAAA,iBAAA;AAAA,EACjB,WAAc,GAAA,GAAA;AAAA,EACd,YAAe,GAAA,GAAA;AACnB,CAAqB,EAAA;AACrB,EAAA,MAAM,MAA8B,EAAC,CAAA;AACrC,EAAA,KAAA,MAAW,QAAQ,YAAc,EAAA;AAC7B,IAAW,KAAA,MAAA,IAAA,IAAQ,KAAK,KAAO,EAAA;AAC3B,MAAA,GAAA,CAAI,CAAG,EAAA,IAAA,CAAK,EAAM,CAAA,CAAA,EAAA,IAAA,CAAK,QAAQ,IAAK,CAAA,GAAA,CAAA;AAAA,KACxC;AAAA,GACJ;AACA,EAAM,MAAA,kBAAA,GAAqB,CAAC,WAAwB,KAAA;AAChD,IAAA,MAAM,MAAM,GAAI,CAAA,WAAA,CAAA,CAAA;AAChB,IAAA,IAAI,GAAK,EAAA;AACL,MAAA,OAAO,CAAe,YAAA,EAAA,YAAA,CAAA,OAAA,EAAsB,GAAe,CAAA,SAAA,EAAA,cAAA,CAAA,OAAA,EAAwB,cAAc,WAAc,CAAA,EAAA,YAAA,CAAA,GAAA,CAAA,CAAA;AAAA,KAC5G,MAAA;AACH,MAAO,OAAA,CAAA,EAAG,cAAc,WAAc,CAAA,EAAA,YAAA,CAAA,CAAA,CAAA;AAAA,KAC1C;AAAA,GACJ,CAAA;AACA,EAAA,MAAM,aAAa,CAAC,IAAA,KAAiB,gBAAgB,WAAa,EAAA,YAAA,EAAc,oBAAoB,IAAI,CAAA,CAAA;AAExG,EAAO,OAAA,SAAS,WAAW,SAA6B,EAAA;AACpD,IAAI,IAAA,OAAO,cAAc,QAAU,EAAA;AAC/B,MAAA,OAAO,WAAW,SAAS,CAAA,CAAA;AAAA,KACxB,MAAA;AACH,MAAA,MAAM,MAAM,SAAU,CAAA,SAAA,CAAA;AACtB,MAAM,MAAA,MAAA,GAAS,WAAW,GAAG,CAAA,CAAA;AAC7B,MAAA,IAAI,MAAW,KAAA,GAAA;AAAK,QAAA,SAAA,CAAU,SAAY,GAAA,MAAA,CAAA;AAAA,KAC9C;AAAA,GACJ,CAAA;AACJ;;;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASE,GAAG,CAACtC,KAAe,EAAE;AAC1B,EAAA,OAAA,CAAA,MAAA;AAAA,IAAA,MAAA,IAAA,GAAA0B,QAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA;IAAAG,MAGS7B,CAAAA,IAAAA,EAAAA,MAAAA,KAAK,CAACuC,IAAI,CAAA,CAAA;AAAA,IAAAR,MAAA,CAAA,GAAA,IAAA;MAAA,MAFG/B,GAAAA,GAAAA,KAAK,CAACwC,QAAQ;QAAA,IAASxC,GAAAA,KAAK,CAACC,KAAK;QAAA,IAASD,GAAAA,KAAK,CAACiC,KAAK,CAAA;AAAA,MAAA,GAAA,KAAA,GAAA,CAAA,GAAA,KAAA,IAAA,CAAA,QAAA,GAAA,GAAA,CAAA,GAAA,GAAA,GAAA,CAAA,CAAA;AAAA,MAAA,GAAA,CAAA,IAAA,GAAAE,KAAA,CAAA,IAAA,EAAA,IAAA,EAAA,GAAA,CAAA,IAAA,CAAA,CAAA;AAAA,MAAA,IAAA,KAAA,GAAA,CAAA,IAAA,IAAAP,SAAA,CAAA,IAAA,EAAA,GAAA,CAAA,IAAA,GAAA,IAAA,CAAA,CAAA;AAAA,MAAA,OAAA,GAAA,CAAA;AAAA,KAAA,EAAA;AAAA,MAAA,GAAA,EAAA,SAAA;AAAA,MAAA,IAAA,EAAA,SAAA;AAAA,MAAA,IAAA,EAAA,SAAA;AAAA,KAAA,CAAA,CAAA;IAAAG,MAC7D/B,CAAAA,MAAAA,IAAAA,CAAAA,KAAAA,GAAAA,KAAK,CAACyC,GAAG,CAAA,CAAA;AAAA,IAAA,OAAA,IAAA,CAAA;AAAA,GAAA,GAAA,CAAA;AAI5B,CAAA;AAQA,MAAMC,MAAM,GAAGjD,GAAG,CAAC;AACfc,EAAAA,KAAK,EAAE,MAAM;AAAEoC,EAAAA,MAAM,EAAE,CAAC;AAAEC,EAAAA,UAAU,EAAE,MAAA;AAC1C,CAAC,CAAC,CAAA;AACF;AACA;AACA;AACA;AACA;AACe,SAASC,IAAI,CAAC7C,KAAgB,EAAE;EAC3C,MAAM8C,UAAU,GAAGC,cAAc,CAAC,MAAM/C,KAAK,CAACgD,WAAW,CAAC,CAAA;AAC1D,EAAA,OAAA,CAAA,MAAA;AAAA,IAAA,MAAA,KAAA,GAAA,OAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA;AAAA,IAAA,KAAA,CAAA,gBAAA,CAAA,QAAA,EAGmBC,CAAC,IAAKjD,KAAK,CAACkD,QAAQ,CAACC,QAAQ,CAACF,CAAC,CAACG,aAAa,CAACC,KAAK,CAAC,CAAC,CAAA,CAAA;IAAA,MAFvDrD,KAAAA,GAAAA,KAAK,CAACsD,GAAG,CAAA;IAAA,OAATtD,KAAAA,KAAAA,UAAAA,GAAAA,GAAAA,CAAAA,KAAAA,EAAAA,KAAAA,CAAAA,GAAAA,KAAK,CAACsD,GAAG,GAAA,KAAA,CAAA;AAAA,IAAAzB,MAAA,CAAA,KAAA,EAAA0B,eAAA,CAGjB,GAAG,EAAA;AAAA,MAAA,IAAC,IAAI,GAAA;QAAA,OAAEvD,KAAK,CAACwD,YAAY,CAAA;AAAA,OAAA;AAAA,MAAA,QAAA,EACxB,CAACC,IAAI,EAAEC,KAAK,qBACR,GAAG,EAAA;AAAA,QAAA,IAAC,GAAG,GAAA;AAAA,UAAA,OAAEA,KAAK,EAAE,CAAA;AAAA,SAAA;AAAA,QAAA,IAAE,IAAI,GAAA;UAAA,OAAED,IAAI,CAAClB,IAAI,CAAA;AAAA,SAAA;AAAA,QAAA,IAC9B,QAAQ,GAAA;AAAA,UAAA,OAAEO,UAAU,CAACY,KAAK,EAAE,CAAC,CAAA;AAAA,SAAA;AAAA,OAAA,CAAA;AAAI,KAAA,CAAA,CAAA,CAAA;IAAA3B,MALlC,CAAA,GAAA,IAAAK,SAAA,CAAA,KAAA,EAAA;MAAE,CAACM,MAAM,GAAG,IAAI;AAAE,MAAA,CAACiB,WAAW,GAAG,IAAA;KAAM,EAAA,GAAA,CAAA,CAAA,CAAA;AAAA,IAAA,OAAA,KAAA,CAAA;AAAA,GAAA,GAAA,CAAA;AAU9D;;ACpDO,MAAM,kBAAkB,aAAmC,EAAA;;ACHlE,yBAAe;;ACAf,uBAAe;;ACWR,MAAM,CAAC,YAAc,EAAA,eAAe,CAAI,GAAA,WAAA,CAA+B,EAAS,EAAA;AAEhF,MAAM,YAAkC,GAAA;AAAA,EAC3C,GAAK,EAAA;AAAA,IACD,OAAW,EAAA,gBAAA;AAAA,IACX,KAAO,EAAA,cAAA;AAAA,GACX;AACJ,EAAA;AAIO,MAAM,oBAA0C,GAAA;AAAA,EACnD,GAAK,EAAA;AAAA,IACD,OAAS,EAAA,+EAAA;AAAA,IACT,KAAO,EAAA,mEAAA;AAAA,GACX;AACJ;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,SAASC,SAAS,CAACC,IAAoB,EAAE;AACpD,EAAA,MAAM,CAAC;AAAEC,IAAAA,KAAAA;GAAO,EAAEC,SAAS,CAAC,GAAGC,UAAU,CAACH,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC,CAAA;AAC1D,EAAA,OAAA,CAAA,MAAA;AAAA,IAAA,MAAA,IAAA,GAAAnC,QAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA;AAAA,IAAAuC,MAAA,CAAA,IAAA,EAAAC,UAAA,CAAA;AAAA,MAAA,IAAY,GAAG,GAAA;AAAA,QAAA,OAAEC,YAAY,CAACC,GAAG,CAACN,KAAK,CAAC,CAAA;AAAA,OAAA;AAAA,KAAA,EAAMC,SAAS,CAAA,EAAA,KAAA,EAAA,KAAA,CAAA,CAAA;AAAA,IAAA,OAAA,IAAA,CAAA;AAAA,GAAA,GAAA,CAAA;AAC3D;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASM,QAAQ,CAACrE,KAAoB,EAAE;EACnD,MAAM,CAACsE,MAAM,EAAEC,SAAS,CAAC,GAAGpE,YAAY,CAAC,KAAK,CAAC,CAAA;EAC/C,MAAM,CAACqE,KAAK,EAAEC,QAAQ,CAAC,GAAGtE,YAAY,CAAC,KAAK,CAAC,CAAA;EAC7C,MAAMuE,WAAW,GAAG,MAAM;IACtBH,SAAS,CAAC,KAAK,CAAC,CAAA;IAChBE,QAAQ,CAAC,IAAI,CAAC,CAAA;GACjB,CAAA;EACD,MAAME,UAAU,GAAG,MAAM;IACrBJ,SAAS,CAAC,IAAI,CAAC,CAAA;IACfE,QAAQ,CAAC,KAAK,CAAC,CAAA;GAClB,CAAA;AAED,EAAA,MAAM,CAACG,IAAI,EAAEC,WAAW,CAAC,GAAGb,UAAU,CAAChE,KAAK,EAAE,CAAC,MAAM,CAAC,CAAC,CAAA;AACvD,EAAA,MAAM8E,OAAO,GAAGC,UAAU,CAACC,eAAe,CAAC,CAAA;AAC3C,EAAA,OAAA,CAAAC,IAAA,CAAA,CAAA,MAAA;AAAA,IAAA,MAAA,GAAA,GAAAA,IAAA,CAAA,MAAA,CAAA,EAEU,CAACX,MAAM,EAAE,IAAIE,KAAK,EAAE,CAAA,CAAA,CAAA;AAAA,IAAA,OAAA,MAArB,yBACI,SAAS,EAAAN,UAAA,CAAA;AAAA,MAAA,IACN,KAAK,GAAA;AAAA,QAAA,OAAEM,KAAK,EAAE,GAAG,OAAO,GAAG,SAAS,CAAA;AAAA,OAAA;AAAA,MAAA,IACpC,GAAG,GAAA;QAAA,OAAEI,IAAI,CAACA,IAAI,CAACM,KAAK,IAAIN,IAAI,CAACA,IAAI,CAACO,EAAE,CAAA;AAAA,OAAA;AACpC,MAAA,KAAK,EAAE;AAAE,6BAAsBC,UAAU,EAAE,iBAAA;AAAkB,OAAA;AAAC,KAAA,EAC1DP,WAAW,CACjB,CAAA,CAAA;AAAA,GAAA,GAAA,CAAA,EAAA,CAAA,MAAA;AAAA,IAAA,MAAA,IAAA,GAAAnD,QAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA;AAAA,IAAAuC,MAAA,CAAA,IAAA,EAAAC,UAAA,CACGW,WAAW,EAAA;AAAA,MAAA,IAChB,GAAG,GAAA;AAAA,QAAA,OAAED,IAAI,CAACA,IAAI,CAACS,GAAG,CAAA;AAAA,OAAA;AAAA,MAAA,IAClB,GAAG,GAAA;QAAA,OAAET,IAAI,CAACA,IAAI,CAACM,KAAK,IAAIN,IAAI,CAACA,IAAI,CAACO,EAAE,CAAA;AAAA,OAAA;AAAA,MAAA,IACpC,OAAO,GAAA;QAAA,OAAEL,OAAO,EAAEQ,MAAM,CAACC,IAAI,CAACjE,SAAS,EAAEsD,IAAI,CAACA,IAAI,CAAC,CAAA;AAAA,OAAA;AAAA,MAAA,IACnD,cAAc,GAAA;QAAA,OAAEE,OAAO,EAAEU,OAAO,CAACD,IAAI,CAACjE,SAAS,EAAEsD,IAAI,CAACA,IAAI,CAAC,CAAA;AAAA,OAAA;AAAA,MAAA,IAC3D,YAAY,GAAA;QAAA,OAAEE,OAAO,EAAEU,OAAO,CAACD,IAAI,CAACjE,SAAS,EAAEA,SAAS,CAAC,CAAA;AAAA,OAAA;AAAA,MAAA,QAAA,EACjDqD,UAAU;AAAA,MAAA,QAAA,EACV,CAACL,MAAM;MAAA,SACNI,EAAAA,WAAAA;AAAW,KAAA,CAAA,EAAA,KAAA,EAAA,KAAA,CAAA,CAAA;AAAA,IAAA,OAAA,IAAA,CAAA;AAAA,GAAA,GAAA,CAAA,CAAA;AAGpC;;;AC7CA,MAAMe,QAAQ,GAAGhG,GAAG,CAAC;AACjBiG,EAAAA,IAAI,EAAE,CAAC;AAAEnF,EAAAA,KAAK,EAAE,MAAM;AAAEoF,EAAAA,MAAM,EAAE,MAAM;AAAEC,EAAAA,OAAO,EAAE,iBAAA;AACrD,CAAC,CAAC,CAAA;AACF,MAAMC,QAAQ,GAAGpG,GAAG,CAAC;AACjBqG,EAAAA,QAAQ,EAAE,MAAM;AAAEC,EAAAA,QAAQ,EAAE,MAAM;AAAEC,EAAAA,GAAG,EAAE,CAAA;AAC7C,CAAC,CAAC,CAAA;AAYa,SAASC,WAAW,CAACjG,KAAsB,EAAE;AACxD,EAAA,OAAA,CAAA,MAAA;AAAA,IAAA,MAAA,IAAA,GAAA0B,QAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA;AAAA,IAAAE,SAAA,CAAA,IAAA,EAAmBiE,QAAQ,CAAA,CAAA;AAAA,IAAAhE,MAAA,CAAA,IAAA,EAAA0B,eAAA,CACtB,GAAG,EAAA;AAAA,MAAA,IAAC,IAAI,GAAA;AAAA,QAAA,OAAEvD,KAAK,CAACkG,WAAW,CAACC,KAAK,CAAA;AAAA,OAAA;MAAA,QAE1BvB,EAAAA,IAAI,oBAAK,QAAQ,EAAA;AACb,QAAA,IAAI,EAAEA,IAAI;QAAA,OACHa,EAAAA,QAAAA;AAAQ,OAAA,CAAA;AAAI,KAAA,CAAA,CAAA,CAAA;AAAA,IAAA,OAAA,IAAA,CAAA;AAAA,GAAA,GAAA,CAAA;AAKvC;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACO,SAASW,kBAAkB,GAAG;AACjC,EAAA,MAAM,CAACC,UAAU,EAAEb,OAAO,CAAC,GAAGrF,YAAY,EAAoB,CAAA;AAE9D,EAAA,OAAO,CAAC;AACJkG,IAAAA,UAAAA;GACH;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACI,SAASC,YAAY,CAACtG,KAAwB,EAAE;IAC5C,MAAM,CAACuG,cAAc,EAAEC,MAAM,CAAC,GAAGrG,YAAY,CAAC,CAAC,CAAC,CAAA;;AAEhD;AACR;AACQ;AACR;AACA;AACA;AACA;AACQ;AACR;AACA;AACA;;IAEQ,MAAMsG,aAAa,GAAG,MAAM;MACxB,MAAMC,MAAM,GAAG1G,KAAK,CAAC2G,SAAS,CAACC,MAAM,GAAG,CAAC,CAAA;MACzC,MAAMC,IAAI,GAAGN,cAAc,EAAE,CAAA;AAC7B,MAAA,IAAIM,IAAI,GAAGH,MAAM,EAAE,OAAOA,MAAM,CAAC;AACjC,MAAA,OAAOG,IAAI,CAAA;KACd,CAAA;IAED,OAAQtD,eAAA,CAAA,eAAe,CAAC,QAAQ,EAAA;AAAC,MAAA,KAAK,EAClC;AACI+B,QAAAA,MAAM,EAAGV,IAAI,IAAK5E,KAAK,CAACkD,QAAQ,CAAClD,KAAK,CAAC2G,SAAS,CAACF,aAAa,EAAE,CAAC,EAAE7B,IAAI,CAAC;AACxEY,QAAAA,OAAAA;OACH;AAAA,MAAA,IAAA,QAAA,GAAA;AAAA,QAAA,MAAA,IAAA,GAAA,MAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA;QAAA,MAESxF,KAAAA,GAAAA,KAAK,CAACsD,GAAG,CAAA;QAAA,OAATtD,KAAAA,KAAAA,UAAAA,GAAAA,GAAAA,CAAAA,KAAAA,EAAAA,IAAAA,CAAAA,GAAAA,KAAK,CAACsD,GAAG,GAAA,IAAA,CAAA;AAAA,QAAAzB,MAAA,CAAA,IAAA,EAAA0B,eAAA,CAUd,IAAI,EAAA;AAAA,UAAA,IAAC,YAAY,GAAA;YAAA,OAAEvD,KAAK,CAAC2G,SAAS,CAAA;AAAA,WAAA;AAAA,UAAA,IAC/B,WAAW,GAAA;AAAA,YAAA,OAAEF,aAAa,EAAE,CAAA;AAAA,WAAA;AAC5B,UAAA,QAAQ,EAAED,MAAAA;AAAM,SAAA,CAAA,EAAA,IAAA,CAAA,CAAA;AAAA,QAAA3E,MAAA,CAAA,IAAA,EAAA,CAAA,MAAA;UAAA,MAGhB7B,GAAAA,GAAAA,IAAAA,CAAAA,MAAAA,CAAAA,CAAAA,KAAK,CAAC8G,WAAW,CAAA,CAAA;AAAA,UAAA,OAAA,MAAjB,yBACC,WAAW,EAAA;AAAA,YAAA,IAAC,WAAW,GAAA;AAAA,cAAA,OAAE9G,KAAK,CAAC2G,SAAS,CAACF,aAAa,EAAE,CAAC,CAAA;AAAA,aAAA;WAAI,CAAA,CAAA;AAAA,SAAA,GAAA,EAAA,IAAA,CAAA,CAAA;AAAA,QAAA1E,MAAA,CAAA,GAAA,IAAA;UAAA,MAfvD/B,GAAAA,GAAAA,KAAK,CAACiC,KAAK,GAAG;cACrB,CAACjC,KAAK,CAACiC,KAAK,GAAG,IAAA;AACnB,aAAC,GAAG;cACA,CAAC8E,YAAY,GAAG,IAAI;cACpB,CAACpD,WAAW,GAAG,IAAI;AACnB,cAAA,CAACqD,IAAI,GAAG,IAAA;aACX;YAAA,IACMhH,GAAAA,KAAK,CAACC,KAAK,CAAA;AAAA,UAAA,GAAA,CAAA,GAAA,GAAAmC,SAAA,CAAA,IAAA,EAAA,GAAA,EAAA,GAAA,CAAA,GAAA,CAAA,CAAA;AAAA,UAAA,GAAA,CAAA,IAAA,GAAAD,KAAA,CAAA,IAAA,EAAA,IAAA,EAAA,GAAA,CAAA,IAAA,CAAA,CAAA;AAAA,UAAA,OAAA,GAAA,CAAA;AAAA,SAAA,EAAA;AAAA,UAAA,GAAA,EAAA,SAAA;AAAA,UAAA,IAAA,EAAA,SAAA;AAAA,SAAA,CAAA,CAAA;AAAA,QAAA,OAAA,IAAA,CAAA;AAAA,OAAA;AAAA,KAAA,CAAA,CAAA;AAY9B,GAAC,CAAC,CAAA;AACN;;ACtCgB,SAAA,cAAA,CAAe,MAAkB,UAA6C,EAAA;AAC1F,EAAA,MAAM,QAAQ,OAAO,IAAA,IAAQ,WAAW,EAAE,EAAA,EAAI,MAAS,GAAA,IAAA,CAAA;AACvD,EAAA,MAAM,WAAW,CAAC,EAAA,KAAe,gBAAgB,GAAK,EAAA,GAAA,EAAK,CAAC,GAAQ,KAAA;AAChE,IAAA,IAAI,OAAO,IAAM,EAAA;AACb,MAAA,OAAO,KAAM,CAAA,EAAA,CAAA;AAAA,KACjB,MAAA,IAAW,OAAO,UAAY,EAAA;AAC1B,MAAA,OAAO,UAAW,CAAA,GAAA,CAAA,CAAA;AAAA,KACf,MAAA;AACH,MAAA,OAAO,CAAI,CAAA,EAAA,GAAA,CAAA,CAAA,CAAA,CAAA;AAAA,KACf;AAAA,KACD,EAAE,CAAA,CAAA;AACL,EAAM,MAAA,EAAE,GAAQ,EAAA,GAAA,SAAA,EAAc,GAAA,KAAA,CAAA;AAC9B,EAAO,OAAA;AAAA,IACH,GAAG,SAAA;AAAA,IAAW,KAAK,QAAS,CAAA,GAAA,IAAO,SAAS,GAAG,CAAA,IAAK,WAAW,OAAQ,CAAA;AAAA,GAC3E,CAAA;AACJ;;ACzEO,MAAM,UACT,GAAA,CAAC,GAAgB,KAAA,KAAA,CAAM,GAAG,CACrB,CAAA,IAAA;AAAA,EACG,CAAC,QAAa,KAAA;AACV,IAAA,IAAI,SAAS,EAAI,EAAA;AACb,MAAA,OAAO,SAAS,IAAK,EAAA,CAAA;AAAA,KAClB,MAAA;AACH,MAAA,MAAM,IAAI,KAAM,CAAA,CAAA,wBAAA,EAA2B,QAAS,CAAA,MAAA,CAAA,EAAA,EAAW,SAAS,UAAY,CAAA,CAAA,CAAA,CAAA;AAAA,KACxF;AAAA,GACJ;AACJ,CAAA;;ACRR,eAAsB,wBAAwB,GAAa,EAAA;AACvD,EAAM,MAAA,IAAA,GAAiC,MAAM,UAAA,CAAW,GAAG,CAAA,CAAA;AAC3D,EAAA,IAAI,IAAM,EAAA;AACN,IAAA,kBAAA,CAAmB,IAAI,CAAA,CAAA;AACvB,IAAO,OAAA,IAAA,CAAA;AAAA,GACX;AACA,EAAM,MAAA,IAAI,KAAM,CAAA,CAAA,4BAAA,EAA+B,GAAc,CAAA,SAAA,CAAA,CAAA,CAAA;AACjE,CAAA;AACO,SAAS,mBAAmB,SAAqC,EAAA;AACpE,EAAA,KAAA,MAAW,QAAQ,SAAW,EAAA;AAC1B,IAAK,IAAA,CAAA,KAAA,GAAQ,KAAK,KAAM,CAAA,GAAA,CAAI,CAAC,IAAS,KAAA,cAAA,CAAe,IAAM,EAAA,IAAI,CAAC,CAAA,CAAA;AAAA,GACpE;AACJ;;ACRO,SAAS8E,cAAc,CAACzD,YAA2B,EAAE;EACxD,MAAM0D,MAAM,GAAGC,kBAAkB,CAAC;AAC9B3D,IAAAA,YAAY,EAAEA,YAAAA;AAClB,GAAC,CAAC,CAAA;EACF4D,eAAe,CAACC,YAAY,CAAC,CAAA;EAE7BC,QAAQ,CAACC,gBAAgB,CAAC,mEAAmE,CAAC,CAACC,OAAO,CAACN,MAAM,CAAC,CAAA;AAClH,CAAA;AACO,SAASO,cAAc,CAACjE,YAA2B,EAAE;AACxD,EAAA,IAAIkE,UAA8B,CAAA;AAClC,EAAA,IAAIC,WAA0D,CAAA;AAC9D,EAAA,IAAI,CAACD,UAAU,GAAGJ,QAAQ,CAACM,aAAa,CAAc,cAAc,CAAC,MAC7DD,WAAW,GAAGL,QAAQ,CAACM,aAAa,CAAC,UAAU,CAAC,CAAC,EACvD;AACE,IAAA,MAAM,CAAC;AAAEvB,MAAAA,UAAAA;AAAW,KAAC,EAAEC,YAAY,CAAC,GAAGF,kBAAkB,EAAE,CAAA;IAC3D,MAAM,CAACyB,IAAI,EAAEC,OAAO,CAAC,GAAG3H,YAAY,CAAC,IAAI,CAAC,CAAA;IAC1C,MAAM,CAAC2G,WAAW,EAAEiB,cAAc,CAAC,GAAG5H,YAAY,CAAC,KAAK,CAAC,CAAA;IAEzD+G,MAAM,CAAC,sBAAO,YAAY,EAAA;AAAC,MAAA,SAAS,EAAE1D,YAAY;AAAA,MAAA,IAC9C,WAAW,GAAA;AAAA,QAAA,OAAEsD,WAAW,EAAE,CAAA;AAAA,OAAA;AAC1B,MAAA,UAAU,EAAE,MAAMgB,OAAO,CAAC,IAAI,CAAC;AAAA,MAAA,IAC/B,KAAK,GAAA;AAAA,QAAA,OAAG,WAAUD,IAAI,EAAE,GAAG,MAAM,GAAG,OAAQ,CAAC,CAAA,CAAA;AAAA,OAAA;AAC7C,MAAA,QAAQ,EAAE,CAACG,IAAI,EAAEpD,IAAI,KAAK;QACtB+C,WAAW,CAAEtE,KAAK,IAAK,CAAG2E,CAAAA,EAAAA,IAAI,CAAC7C,EAAG,CAAGP,CAAAA,EAAAA,IAAI,CAACO,EAAG,CAAE,CAAA,CAAA,CAAA;AACnD,OAAA;KAAK,CAAA,EAAEuC,UAAU,CAAC,CAAA;AACtB;IACAJ,QAAQ,CAACW,cAAc,CAAC,gBAAgB,CAAC,EAAEC,gBAAgB,CAAC,OAAO,EAAE,MAAM;MACvEH,cAAc,CAAC,IAAI,CAAC,CAAA;AACpBD,MAAAA,OAAO,CAACK,IAAI,IAAI,CAACA,IAAI,CAAC,CAAA;AAC1B,KAAC,CAAC,CAAA;;AAEF;AACA,IAAA,MAAMC,IAAI,GAAGd,QAAQ,CAACe,aAAa,CAAC,KAAK,CAAC,CAAA;AAC1Cf,IAAAA,QAAQ,CAACgB,IAAI,CAACC,MAAM,CAACH,IAAI,CAAC,CAAA;AAC1BlB,IAAAA,MAAM,CAAC,MAAM;MACT,MAAMpF,UAAU,GAAG,MAAM;QACrB,MAAM8C,IAAI,GAAGyB,UAAU,EAAE,CAAA;QACzB,OAAOzB,IAAI,GAAIA,IAAI,CAACM,KAAK,IAAIN,IAAI,CAACO,EAAE,GAAI7D,SAAS,CAAA;OACpD,CAAA;AACD,MAAA,OAAAiC,eAAA,CAAQ,IAAI,EAAA;AAAA,QAAA,IAAC,MAAM,GAAA;UAAA,OAAE8C,UAAU,EAAE,EAAEhB,GAAG,CAAA;AAAA,SAAA;AAAA,QAAA,IAAE,UAAU,GAAA;AAAA,UAAA,OAAEvD,UAAU,EAAE,CAAA;AAAA,SAAA;AAAE,QAAA,MAAM,EAAE4F,UAAU;QAAG,IAAI,EAAA,IAAA;AAAA,OAAA,CAAA,CAAA;KAC9F,EAAEU,IAAI,CAAC,CAAA;AACZ,GAAA;AACJ;;;;"}